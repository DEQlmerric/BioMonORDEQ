---
title: "StreamCat Years"
author: "S. Berzins, A. Thompson"
date: "2025-12-09"
output: html_document
---

#### **PREFACE:** This script explores the creation of a site-specific reference benchmark for total suspended solids (TSS) for ESM 566 Fall Environmental Statistics final project.

V2 = cleaned up code from the class version.

# **1 - LOAD PACKAGES**

```{r warning=FALSE}
library(tidyverse)
library(StreamCatTools) 
library(readxl)
```

# **2 - IMPORT COMIDS**

```{r}
tss <- read_excel("~/BioMonORDEQ/Benchmarks/Water Chemistry/TSS Class Project/TSS_amb_2025-11-12.xlsx") #output file from ref benchmarks script - Ambient sites included

comids <- tss %>% 
  select(COMID) %>%  #get just the COMIDs for next step
  filter(!COMID %in% c("23774647", "23877125","23810652")) # REMOVE UNWANTED COMIDS FOR SITES ON HIGH RES NHD
```

## WATERSHED PREDICTOR VARIABLES - *FROM EPA STREAMCAT*

#### Learn about StreamCat predictors: <https://www.epa.gov/national-aquatic-resource-surveys/streamcat-metrics-and-definitions>

#### View StreamCat updates: <https://www.epa.gov/national-aquatic-resource-surveys/streamcat-updates>

#### Make table of StreamCat metadata and clean up in Excel

```{r}
# METHOD 1: FIND QUERY-ABLE METRIC NAMES
partable <- StreamCatTools::sc_get_metric_names()
#write_xlsx(partable, path = paste0("C://Users//sberzin//OneDrive - Oregon//Desktop//partable", Sys.Date(), ".xlsx"))

# METHOD 2: FIND QUERY-ABLE METRIC NAMES (slightly different than above)
#scpar <- StreamCatTools::sc_get_params(param = 'metric_names') 

#metrics_desc <- read_excel("~/BioMonORDEQ/Benchmarks/Water Chemistry/TSS Class Project/StreamCatMetrics_new.xlsx") #final cleaned-up metrics table

# FOR TESTING INDIVIDUAL METRICS/COMIDS (e.g., to ensure names match)
#test <- StreamCatTools::sc_get_data(comid = '23910659', metric = 'precipminusevt', showAreaSqKm = FALSE, aoi='watershed')
#test <- StreamCatTools::sc_get_data(comid = '23910659', metric = 'thalwegdepth', showAreaSqKm = FALSE, aoi='other')
```

#### Run function to query ALL StreamCat data for selected COMIDs by subcategory

```{r}
# NOTE: StreamCat doesn't pull data for 'other' areas of interest when aoi='watershed, catchment, other'. 
# Instead, use aoi='watershed' and run separate line for aoi='other' since they don't pull unless on their own.
# ALSO: Do not separate metric lists onto a new line by hitting the enter button, as any metric after the break will be excluded from the pull.

# FUNCTION - START +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
get_streamcat <- function(comids, type = c("pctagslphigh","pctagslpmid","pctbl","pctconif","pctcrop","pctdecid","pctgrs","pcthay","pcthbwet","pctice","pctimp","pctimpslphigh","pctimpslpmid","pctmxfst","pctow","pctshrb","pcturbhi","pcturblo","pcturbmd","pcturbop","pctwdwet","pctburnarea","pcthighsev","pctincvegresp","pctlowsev","pctmodsev","pctnofire","pctnonprocmask","pctundsev","pctfire","pctfrstloss"
))
  {
type <- match.arg(type)
#comids_split <- split(comids, ceiling(seq_along(comids)/750)) #removed b/c doesn't seem to be doing anything - wrong data class??

if(type == "pctagslphigh"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctagslphigh2001,pctagslphigh2004,pctagslphigh2006,pctagslphigh2008,pctagslphigh2011,pctagslphigh2013,pctagslphigh2016,pctagslphigh2019
',
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed')) 
  }

if(type == "pctagslpmid"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctagslpmid2001,pctagslpmid2004,pctagslpmid2006,pctagslpmid2008,pctagslpmid2011,pctagslpmid2013,pctagslpmid2016,pctagslpmid2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctbl"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctbl2001,pctbl2004,pctbl2006,pctbl2008,pctbl2011,pctbl2013,pctbl2016,pctbl2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctconif"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctconif2001,pctconif2004,pctconif2006,pctconif2008,pctconif2011,pctconif2013,pctconif2016,pctconif2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctcrop"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctcrop2001,pctcrop2004,pctcrop2006,pctcrop2008,pctcrop2011,pctcrop2013,pctcrop2016,pctcrop2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctdecid"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctdecid2001,pctdecid2004,pctdecid2006,pctdecid2008,pctdecid2011,pctdecid2013,pctdecid2016,pctdecid2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctgrs"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctgrs2001,pctgrs2004,pctgrs2006,pctgrs2008,pctgrs2011,pctgrs2013,pctgrs2016,pctgrs2019',
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pcthay"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcthay2001,pcthay2004,pcthay2006,pcthay2008,pcthay2011,pcthay2013,pcthay2016,pcthay2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pcthbwet"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcthbwet2001,pcthbwet2004,pcthbwet2006,pcthbwet2008,pcthbwet2011,pcthbwet2013,pcthbwet2016,pcthbwet2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctice"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctice2001,pctice2004,pctice2006,pctice2008,pctice2011,pctice2013,pctice2016,pctice2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctimp"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctimp2001,pctimp2004,pctimp2006,pctimp2008,pctimp2011,pctimp2013,pctimp2016,pctimp2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctimpslphigh"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctimpslphigh2001,pctimpslphigh2004,pctimpslphigh2006,pctimpslphigh2008,pctimpslphigh2011,pctimpslphigh2013,pctimpslphigh2016,pctimpslphigh2019
', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed')) 
  }
if(type == "pctimp"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctimp2001,pctimp2004,pctimp2006,pctimp2008,pctimp2011,pctimp2013,pctimp2016,pctimp2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctimpslphigh"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctimpslphigh2001,pctimpslphigh2004,pctimpslphigh2006,pctimpslphigh2008,pctimpslphigh2011,pctimpslphigh2013,pctimpslphigh2016,pctimpslphigh2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctimpslpmid"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctimpslpmid2001,pctimpslpmid2004,pctimpslpmid2006,pctimpslpmid2008,pctimpslpmid2011,pctimpslpmid2013,pctimpslpmid2016,pctimpslpmid2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctmxfst"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctmxfst2001,pctmxfst2004,pctmxfst2006,pctmxfst2008,pctmxfst2011,pctmxfst2013,pctmxfst2016,pctmxfst2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctow"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctow2001,pctow2004,pctow2006,pctow2008,pctow2011,pctow2013,pctow2016,pctow2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctshrb"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctshrb2001,pctshrb2004,pctshrb2006,pctshrb2008,pctshrb2011,pctshrb2013,pctshrb2016,pctshrb2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pcturbhi"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcturbhi2001,pcturbhi2004,pcturbhi2006,pcturbhi2008,pcturbhi2011,pcturbhi2013,pcturbhi2016,pcturbhi2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pcturblo"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcturblo2001,pcturblo2004,pcturblo2006,pcturblo2008,pcturblo2011,pcturblo2013,pcturblo2016,pcturblo2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pcturbmd"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcturbmd2001,pcturbmd2004,pcturbmd2006,pcturbmd2008,pcturbmd2011,pcturbmd2013,pcturbmd2016,pcturbmd2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pcturbop"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcturbop2001,pcturbop2004,pcturbop2006,pcturbop2008,pcturbop2011,pcturbop2013,pcturbop2016,pcturbop2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctwdwet"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctwdwet2001,pctwdwet2004,pctwdwet2006,pctwdwet2008,pctwdwet2011,pctwdwet2013,pctwdwet2016,pctwdwet2019', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))

}

if(type == "pctburnarea"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctburnarea,pctburnarea1981,pctburnarea1982,pctburnarea1983,pctburnarea1984,pctburnarea1985,pctburnarea1986,pctburnarea1987,pctburnarea1988,pctburnarea1989,pctburnarea1990,pctburnarea1991,pctburnarea1992,pctburnarea1993,pctburnarea1994,pctburnarea1995,pctburnarea1996,pctburnarea1997,pctburnarea1998,pctburnarea1999,pctburnarea2000,pctburnarea2001,pctburnarea2002,pctburnarea2003,pctburnarea2004,pctburnarea2005,pctburnarea2006,pctburnarea2007,pctburnarea2008,pctburnarea2009,pctburnarea2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pcthighsev"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pcthighsev,pcthighsev1981,pcthighsev1982,pcthighsev1983,pcthighsev1984,pcthighsev1985,pcthighsev1986,pcthighsev1987,pcthighsev1988,pcthighsev1989,pcthighsev1990,pcthighsev1991,pcthighsev1992,pcthighsev1993,pcthighsev1994,pcthighsev1995,pcthighsev1996,pcthighsev1997,pcthighsev1998,pcthighsev1999,pcthighsev2000,pcthighsev2001,pcthighsev2002,pcthighsev2003,pcthighsev2004,pcthighsev2005,pcthighsev2006,pcthighsev2007,pcthighsev2008,pcthighsev2009,pcthighsev2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctincvegresp"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctincvegresp,pctincvegresp1981,pctincvegresp1982,pctincvegresp1983,pctincvegresp1984,pctincvegresp1985,pctincvegresp1986,pctincvegresp1987,pctincvegresp1988,pctincvegresp1989,pctincvegresp1990,pctincvegresp1991,pctincvegresp1992,pctincvegresp1993,pctincvegresp1994,pctincvegresp1995,pctincvegresp1996,pctincvegresp1997,pctincvegresp1998,pctincvegresp1999,pctincvegresp2000,pctincvegresp2001,pctincvegresp2002,pctincvegresp2003,pctincvegresp2004,pctincvegresp2005,pctincvegresp2006,pctincvegresp2007,pctincvegresp2008,pctincvegresp2009,pctincvegresp2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctlowsev"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctlowsev,pctlowsev1981,pctlowsev1982,pctlowsev1983,pctlowsev1984,pctlowsev1985,pctlowsev1986,pctlowsev1987,pctlowsev1988,pctlowsev1989,pctlowsev1990,pctlowsev1991,pctlowsev1992,pctlowsev1993,pctlowsev1994,pctlowsev1995,pctlowsev1996,pctlowsev1997,pctlowsev1998,pctlowsev1999,pctlowsev2000,pctlowsev2001,pctlowsev2002,pctlowsev2003,pctlowsev2004,pctlowsev2005,pctlowsev2006,pctlowsev2007,pctlowsev2008,pctlowsev2009,pctlowsev2010',
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctmodsev"){

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctmodsev,pctmodsev1981,pctmodsev1982,pctmodsev1983,pctmodsev1984,pctmodsev1985,pctmodsev1986,pctmodsev1987,pctmodsev1988,pctmodsev1989,pctmodsev1990,pctmodsev1991,pctmodsev1992,pctmodsev1993,pctmodsev1994,pctmodsev1995,pctmodsev1996,pctmodsev1997,pctmodsev1998,pctmodsev1999,pctmodsev2000,pctmodsev2001,pctmodsev2002,pctmodsev2003,pctmodsev2004,pctmodsev2005,pctmodsev2006,pctmodsev2007,pctmodsev2008,pctmodsev2009,pctmodsev2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctnofire"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctnofire,pctnofire1981,pctnofire1982,pctnofire1983,pctnofire1984,pctnofire1985,pctnofire1986,pctnofire1987,pctnofire1988,pctnofire1989,pctnofire1990,pctnofire1991,pctnofire1992,pctnofire1993,pctnofire1994,pctnofire1995,pctnofire1996,pctnofire1997,pctnofire1998,pctnofire1999,pctnofire2000,pctnofire2001,pctnofire2002,pctnofire2003,pctnofire2004,pctnofire2005,pctnofire2006,pctnofire2007,pctnofire2008,pctnofire2009,pctnofire2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctnonprocmask"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctnonprocmask,pctnonprocmask1981,pctnonprocmask1982,pctnonprocmask1983,pctnonprocmask1984,pctnonprocmask1985,pctnonprocmask1986,pctnonprocmask1987,pctnonprocmask1988,pctnonprocmask1989,pctnonprocmask1990,pctnonprocmask1991,pctnonprocmask1992,pctnonprocmask1993,pctnonprocmask1994,pctnonprocmask1995,pctnonprocmask1996,pctnonprocmask1997,pctnonprocmask1998,pctnonprocmask1999,pctnonprocmask2000,pctnonprocmask2001,pctnonprocmask2002,pctnonprocmask2003,pctnonprocmask2004,pctnonprocmask2005,pctnonprocmask2006,pctnonprocmask2007,pctnonprocmask2008,pctnonprocmask2009,pctnonprocmask2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }

if(type == "pctundsev"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctundsev,pctundsev1981,pctundsev1982,pctundsev1983,pctundsev1984,pctundsev1985,pctundsev1986,pctundsev1987,pctundsev1988,pctundsev1989,pctundsev1990,pctundsev1991,pctundsev1992,pctundsev1993,pctundsev1994,pctundsev1995,pctundsev1996,pctundsev1997,pctundsev1998,pctundsev1999,pctundsev2000,pctundsev2001,pctundsev2002,pctundsev2003,pctundsev2004,pctundsev2005,pctundsev2006,pctundsev2007,pctundsev2008,pctundsev2009,pctundsev2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }
if(type == "pctfire"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctfire2001,pctfire2002,pctfire2003,pctfire2004,pctfire2005,pctfire2006,pctfire2007,pctfire2008,pctfire2009,pctfire2010', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
}
if(type == "pctfrstloss"){ 

  streamcat <- purrr::map_dfr(comids, ~StreamCatTools::sc_get_data(.,
                                                                           metric = 'pctfrstloss2001,pctfrstloss2002,pctfrstloss2003,pctfrstloss2004,pctfrstloss2005,pctfrstloss2006,pctfrstloss2007,pctfrstloss2008,pctfrstloss2009,pctfrstloss2010,pctfrstloss2011,pctfrstloss2011,pctfrstloss2012', 
                                                                           showAreaSqKm = FALSE,
                                                                           aoi='watershed'))
  }
names(streamcat) <- base::toupper(names(streamcat))
return(streamcat)
}
# FUNCTION - END  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
```

#### Pull ALL StreamCat data and associated site info

```{r}
# PULL DATA 
pull_function  <- function(SC_var) {
  get_streamcat(comids = comids, type = SC_var) %>% 
  inner_join(tss, by='COMID') %>% 
  select(-c(MLocID,Lat_DD,Long_DD, EcoRegion4, HUC8, cal_val, TSS)) %>% 
  relocate(COMID, .after = ReferenceSite) %>% 
  pivot_longer(
    cols = starts_with(SC_var),
    names_to = "variable",
    values_to = "values"
  )
}

a<- pull_function("pctagslphigh")
b<- pull_function("pctagslpmid")
c<- pull_function("pctbl")
d<-pull_function("pctconif")
e<-pull_function("pctcrop")
f<-pull_function("pctdecid")
g<-pull_function("pctgrs")
h<-pull_function("pcthay")
i<-pull_function("pcthbwet")
j<-pull_function("pctice")
k<-pull_function("pctimp")
l<-pull_function("pctimpslphigh")
m<-pull_function("pctimpslpmid")
n<-pull_function("pctmxfst")
o<-pull_function("pctow")
p<-pull_function("pctshrb")
q<-pull_function("pcturbhi")
r<-pull_function("pcturblo")
s<-pull_function("pcturbmd")
t<-pull_function("pcturbop")
u<-pull_function("pctwdwet")
v<-pull_function("pctfire")
w<-pull_function("pctfrstloss")

aa<- pull_function("pctburnarea")
bb<- pull_function("pcthighsev")
cc<- pull_function("pctincvegresp")
dd<- pull_function("pctlowsev")
ee<- pull_function("pctmodsev")
ff<- pull_function("pctnofire")
gg<- pull_function("pctnonprocmask")
hh<- pull_function("pctundsev")


```  

####Pull in site info by COMID, and graph
```{r}
# Boxplots

# By L3Ecoregion
plots <- function(data) {
  ggplot(data, aes(x = variable, y = values, fill = L3Eco)) +
    geom_boxplot(fill="slateblue", alpha = 0.2) +
    theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.5)) +
    facet_wrap(~L3Eco)
}
# By reference status
# plots <- function(data) {
#   ggplot(data, aes(x = variable, y = values, fill = ReferenceSite)) +
#     geom_boxplot(fill="slateblue", alpha = 0.2) +
#     theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.5)) +
#     facet_wrap(~ReferenceSite)
# }


plots(a) + scale_y_continuous(trans='log10') + labs(title = "Percent of Agriculture of 20% Slope")
plots(b) + scale_y_continuous(trans='log10') + labs(title = "Percent of Agriculture of 10% Slope")
plots(c) + scale_y_continuous(trans='log10') + labs(title = "Bedrock and Similar Earthen Material Percentage")
plots(d) + scale_y_continuous(trans='log10') + labs(title = "Evergreen Forest Percentage")
plots(e) + scale_y_continuous(trans='log10') + labs(title = "Row Crop Percentage")
plots(f) + scale_y_continuous(trans='log10') + labs(title = "Deciduous Forest Percentage")
plots(g) + scale_y_continuous(trans='log10') + labs(title = "Grassland/Herbaceous Percentage")
plots(h) + scale_y_continuous(trans='log10') + labs(title = "Pasture/Hay Percentage")
plots(i) + scale_y_continuous(trans='log10') + labs(title = "Herbaceous Wetland Percentage")
plots(j) + scale_y_continuous(trans='log10') + labs(title = "Ice/Snow Cover Percentage")
plots(k) + scale_y_continuous(trans='log10') + labs(title = "Mean Imperviousness")
plots(l) + scale_y_continuous(trans='log10') + labs(title = "Percent Imperviousness on 20% Slope")
plots(m) + scale_y_continuous(trans='log10') + labs(title = "Percent Imperviousness on 10% Slope")
plots(n) + scale_y_continuous(trans='log10') + labs(title = "Mixed Deciduous/Evergreen Forest Percentage")
plots(o) + scale_y_continuous(trans='log10') + labs(title = "Shrub/Scrub Percentage")
plots(p) + scale_y_continuous(trans='log10') + labs(title = "Developed, High Intensity Land Use Percentage")
plots(q) + scale_y_continuous(trans='log10') + labs(title = "Developed, Low Intensity Land Use Percentage")
plots(r) + scale_y_continuous(trans='log10') + labs(title = "Developed, Medium Intensity Land Use Percentage")
plots(s) + scale_y_continuous(trans='log10') + labs(title = "Developed, Open Space Land Use Percentage")
plots(t) + scale_y_continuous(trans='log10') + labs(title = "Woody Wetland Percentage")
plots(u) + scale_y_continuous(trans='log10') + labs(title = "Watershed Area Square Kilometers Riparian 100 Meters")
plots(v) + scale_y_continuous(trans='log10') + labs(title = "Forest Fire Loss")
plots(w) + scale_y_continuous(trans='log10') + labs(title = "Forest Loss")

plots(aa) + scale_y_continuous(trans='log10') + labs(title = "Wildfire Burn Percent 1984-2018")
plots(bb) + scale_y_continuous(trans='log10') + labs(title = "Percent High Burn Severity Class For Year")
plots(cc) + scale_y_continuous(trans='log10') + labs(title = "Percent Increased Greenness and Veg Response Class For Year")
plots(dd) + scale_y_continuous(trans='log10') + labs(title = "Percent Low Burn Severity Class For Year")
plots(ee) + scale_y_continuous(trans='log10') + labs(title = "Percent Moderate Burn Severity Class For Year")
plots(ff) + scale_y_continuous(trans='log10') + labs(title = "Percent No Fire Burn Class Class For Year")
plots(gg) + scale_y_continuous(trans='log10') + labs(title = "Percent Non Processing Mask Class For Year")
plots(hh) + scale_y_continuous(trans='log10') + labs(title = "Percent Underburned to Low Burn Severity Class For Year")
```
```{r}
# Line plots

# By ecoregion
# Line plots by ecoregion
plots_lines <- function(data) {
  ggplot(data, aes(x = variable, y = values, group = COMID, color = L3Eco)) +
    geom_point() + geom_line() +
    theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.5))
}

# Line plots by reference status
plots_lines <- function(data) {
  ggplot(data, aes(x = variable, y = values, group = COMID, color = ReferenceSite)) +
    geom_point() + geom_line() +
    theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.5)) +
      scale_color_manual(values = c("MOST DISTURBED" = "red", "MODERATELY DISTURBED" = "blue", "REFERENCE" = "green"))
 }

plots_lines(a) + labs(title = "Percent of Agriculture of 20% Slope")
plots_lines(b) + labs(title = "Percent of Agriculture of 10% Slope")
plots_lines(c) + labs(title = "Bedrock and Similar Earthen Material Percentage")
plots_lines(d) + labs(title = "Evergreen Forest Percentage")
plots_lines(e) + labs(title = "Row Crop Percentage")
plots_lines(f) + labs(title = "Deciduous Forest Percentage")
plots_lines(g) + labs(title = "Grassland/Herbaceous Percentage")
plots_lines(h) + labs(title = "Pasture/Hay Percentage")
plots_lines(i) + labs(title = "Herbaceous Wetland Percentage")
plots_lines(j) + labs(title = "Ice/Snow Cover Percentage")
plots_lines(k) + labs(title = "Mean Imperviousness")
plots_lines(l) + labs(title = "Percent Imperviousness on 20% Slope")
plots_lines(m) + labs(title = "Percent Imperviousness on 10% Slope")
plots_lines(n) + labs(title = "Mixed Deciduous/Evergreen Forest Percentage")
plots_lines(o) + labs(title = "Shrub/Scrub Percentage")
plots_lines(p) + labs(title = "Developed, High Intensity Land Use Percentage")
plots_lines(q) + labs(title = "Developed, Low Intensity Land Use Percentage")
plots_lines(r) + labs(title = "Developed, Medium Intensity Land Use Percentage")
plots_lines(s) + labs(title = "Developed, Open Space Land Use Percentage")
plots_lines(t) + labs(title = "Woody Wetland Percentage")
plots_lines(u) + labs(title = "Watershed Area Square Kilometers Riparian 100 Meters")
plots_lines(v) + labs(title = "Forest Fire Loss")
plots_lines(w) + labs(title = "Forest Loss")

plots_lines(aa) + labs(title = "Wildfire Burn Percent 1984-2018")
plots_lines(bb) + labs(title = "Percent High Burn Severity Class For Year")
plots_lines(cc) + labs(title = "Percent Increased Greenness and Veg Response Class For Year")
plots_lines(dd) + labs(title = "Percent Low Burn Severity Class For Year")
plots_lines(ee) + labs(title = "Percent Moderate Burn Severity Class For Year")
plots_lines(ff) + labs(title = "Percent No Fire Burn Class Class For Year")
plots_lines(gg) + labs(title = "Percent Non Processing Mask Class For Year")
plots_lines(hh) + labs(title = "Percent Underburned to Low Burn Severity Class For Year")

```
